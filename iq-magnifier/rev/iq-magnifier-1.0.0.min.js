!function(i){i.fn.iqMagnifier=function(e){function o(i){"mouseenter"==i.type?(p.css({width:n.magnifierWidth,height:n.magnifierHeight}),q.fadeIn(100),window.onwheel=function(){return!1}):(q.fadeOut(100),window.onwheel=function(){return!0})}function t(i){s(),Y=i.pageX,F=i.pageY,D+.5*y>Y?(p.css({left:-1*n.magnifierBdWidth}),W.css({left:0})):Y>D+T-.5*y?(p.css({left:T-y-n.magnifierBdWidth}),W.css({left:-1*(T-y)})):(p.css({left:Y-D-.5*y-n.magnifierBdWidth}),W.css({left:-1*(Y-D-.5*y)})),I+.5*C>F?(p.css({top:-1*n.magnifierBdWidth}),W.css({top:0})):F>I+x-.5*C?(p.css({top:x-C-n.magnifierBdWidth}),W.css({top:-1*(x-C)})):(p.css({top:F-I-.5*C-n.magnifierBdWidth}),W.css({top:-1*(F-I-.5*C)})),s(),a()}function m(i){s(),i.originalEvent.wheelDelta<0?y+n.zoomScale<T?(Y-.5*(y+n.zoomScale)<D?(p.css({left:-1*n.magnifierBdWidth,width:"+="+n.zoomScale}),W.css({left:0})):Y+.5*(y+n.zoomScale)>j?(p.css({left:-1*n.magnifierBdWidth+T-y-n.zoomScale,width:"+="+n.zoomScale}),W.css({left:-1*(T-y-n.zoomScale)})):(p.css({left:-1*n.magnifierBdWidth+Y-D-.5*(y+n.zoomScale),width:"+="+n.zoomScale}),W.css({left:-1*(Y-D-.5*(y+n.zoomScale))})),F-.5*(C+n.zoomScale)<I?(p.css({top:-1*n.magnifierBdWidth,height:"+="+n.zoomScale}),W.css({top:0})):F+.5*(C+n.zoomScale)>A?(p.css({top:-1*n.magnifierBdWidth+x-C-n.zoomScale,height:"+="+n.zoomScale}),W.css({top:-1*(x-C-n.zoomScale)})):(p.css({top:-1*n.magnifierBdWidth+F-I-.5*(C+n.zoomScale),height:"+="+n.zoomScale}),W.css({top:-1*(F-I-.5*(C+n.zoomScale))}))):(p.css({top:-1*n.magnifierBdWidth,left:-1*n.magnifierBdWidth,width:T,height:x}),W.css({top:0,left:0})):y-n.zoomScale>T*Q?(Y-.5*y+.5*n.zoomScale<D?(p.css({left:-1*n.magnifierBdWidth,width:"-="+n.zoomScale}),W.css({left:0})):Y+.5*y-.5*n.zoomScale>j?(p.css({left:-1*n.magnifierBdWidth+T-y+n.zoomScale,width:"-="+n.zoomScale}),W.css({left:-1*(T-y+n.zoomScale)})):(p.css({left:-1*n.magnifierBdWidth+Y-D-.5*(y-n.zoomScale),width:"-="+n.zoomScale}),W.css({left:-1*(Y-D-.5*(y-n.zoomScale))})),F-.5*C+.5*n.zoomScale<I?(p.css({top:-1*n.magnifierBdWidth,height:"-="+n.zoomScale}),W.css({top:0})):F+.5*C-.5*n.zoomScale>A?(p.css({top:-1*n.magnifierBdWidth+x-C+n.zoomScale,height:"-="+n.zoomScale}),W.css({top:-1*(x-C+n.zoomScale)})):(p.css({top:-1*n.magnifierBdWidth+F-I-.5*(C-n.zoomScale),height:"-="+n.zoomScale}),W.css({top:-1*(F-I-.5*(C-n.zoomScale))}))):(D>Y-T*Q*.5?(p.css({left:-1*n.magnifierBdWidth,width:T*Q}),W.css({left:0})):Y+T*Q*.5>j?(p.css({left:-1*n.magnifierBdWidth+T-T*Q,width:T*Q}),W.css({left:-1*(T-T*Q)})):(p.css({left:-1*n.magnifierBdWidth+Y-D-T*Q*.5,width:T*Q}),W.css({left:-1*(Y-D-T*Q*.5)})),I>F-x*Q*.5?(p.css({top:-1*n.magnifierBdWidth,height:x*Q}),W.css({top:0})):F+x*Q*.5>A?(p.css({top:-1*n.magnifierBdWidth+x-x*Q,height:T*Q}),W.css({top:-1*(x-x*Q)})):(p.css({top:-1*n.magnifierBdWidth+F-I-x*Q*.5,height:x*Q}),W.css({top:-1*(F-D-x*Q*.5)}))),s(),a()}function s(){y=u.width(),C=u.height(),H=u.offset().top,O=u.offset().top+C,b=u.offset().left,X=u.offset().left+y}function a(){var i=T/y;P.css({top:(H-I)*i*-1,left:(b-D)*i*-1,width:T*i,height:x*i})}var g=i(this),n=i.extend({imgMainSrc:"",imgMainWidth:480,imgMainHeight:"",imgMainBdWidth:20,imgMainBdColor:"#CCCCCC",imgPopupSrc:"",imgPopupWidth:480,imgPopupHeight:"",imgPopupBdWidth:20,imgPopupBdColor:"#CCCCCC",imgPopupPosition:"right",imgPopupOffsetX:50,imgPopupOffsetY:0,imgOverlaySrc:"",imgOverlayOffsetX:"",imgOverlayOffsetY:"",magnifierWidth:200,magnifierHeight:"",magnifierBdWidth:10,magnifierBdColor:"#AA0000",zoomScale:20,zoomMaximum:4,dimType:"colored",dimColor:"#2266AA",dimDepth:.4},e);if(n.imgMainHeight||(n.imgMainHeight=n.imgMainWidth),n.imgPopupHeight||(n.imgPopupHeight=n.imgPopupWidth),n.magnifierHeight||(n.magnifierHeight=n.magnifierWidth),n.imgPopupSrc||(n.imgPopupSrc=n.imgMainSrc),"tint"==n.dimType)n.dimColor="#FFFFFF";else if("shade"==n.dimType)n.dimColor="#000000";else if("none"==n.dimType)n.dimDepth=0;else if("colored"!=n.dimType)return alert("Invalid dimType"),!1;var d,f;if("right"==n.imgPopupPosition)d=n.imgMainWidth+n.imgMainBdWidth+n.imgPopupOffsetX,f=n.imgPopupOffsetY;else if("left"==n.imgPopupPosition)d=0-n.imgMainWidth-n.imgMainBdWidth-n.imgPopupOffsetX,f=n.imgPopupOffsetY;else if("top"==n.imgPopupPosition)d=n.imgPopupOffsetX,f=0-n.imgMainHeight-n.imgMainBdWidth-n.imgPopupOffsetY;else{if("bottom"!=n.imgPopupPosition)return alert("Invalid imgPopupPosition"),!1;d=n.imgPopupOffsetX,f=n.imgMainHeight+n.imgMainBdWidth+n.imgPopupOffsetY}var r='<div class="iq-magnifier-wrap"><div class="iq-magnifier-img-main-container-outside"><div class="iq-magnifier-img-main-container-inside"><div class="iq-magnifier-magnifier iq-magnifier-class-hover"><div class="iq-magnifier-img-magnifier-container iq-magnifier-class-hover"><img class="iq-magnifier-img-magnifier iq-magnifier-class-hover" src="'+n.imgMainSrc+'"></div></div><div class="iq-magnifier-dim iq-magnifier-class-hover"></div><img class="iq-magnifier-img-main" src="'+n.imgMainSrc+'"></div></div><div class="iq-magnifier-img-popup-container-outside iq-magnifier-class-hover"><div class="iq-magnifier-img-popup-container-inside iq-magnifier-class-hover"><img class="iq-magnifier-img-popup iq-magnifier-class-hover" src="'+n.imgPopupSrc+'"></div></div></div>';g.append(r);for(var h=g.find(i(".iq-magnifier-wrap")),l=g.find(i(".iq-magnifier-img-main-container-outside")),c=g.find(i(".iq-magnifier-img-main-container-inside")),p=g.find(i(".iq-magnifier-magnifier")),u=g.find(i(".iq-magnifier-img-magnifier-container")),W=g.find(i(".iq-magnifier-img-magnifier")),v=g.find(i(".iq-magnifier-dim")),S=g.find(i(".iq-magnifier-img-main")),B=g.find(i(".iq-magnifier-img-popup-container-outside")),z=g.find(i(".iq-magnifier-img-popup-container-inside")),P=g.find(i(".iq-magnifier-img-popup")),q=g.find(i(".iq-magnifier-class-hover")),w=0;w<n.imgOverlaySrc.length;w++)c.append('<img class="iq-magnifier-img-overlay">');h.css({position:"relative",margin:0,padding:0}),l.css({position:"absolute",top:0,left:0,width:n.imgMainWidth,height:n.imgMainHeight,borderStyle:"solid",borderWidth:n.imgMainBdWidth,borderColor:n.imgMainBdColor}),c.css({position:"relative",width:n.imgMainWidth,height:n.imgMainHeight,cursor:"crosshair"}),p.css({position:"absolute",top:0-n.magnifierBdWidth,left:0-n.magnifierBdWidth,width:n.magnifierWidth,height:n.magnifierHeight,borderStyle:"solid",borderWidth:n.magnifierBdWidth,borderColor:n.magnifierBdColor,zIndex:20,display:"none"}),u.css({position:"relative",width:"100%",height:"100%",overflow:"hidden"}),W.css({position:"absolute",width:n.imgMainWidth,height:n.imgMainHeight}),v.css({position:"absolute",top:0,left:0,width:n.imgMainWidth,height:n.imgMainHeight,backgroundColor:n.dimColor,opacity:n.dimDepth,zIndex:10,display:"none"}),S.css({position:"absolute",top:0,left:0,width:n.imgMainWidth,height:n.imgMainHeight}),B.css({position:"absolute",top:f,left:d,width:n.imgPopupWidth,height:n.imgPopupHeight,borderStyle:"solid",borderWidth:n.imgPopupBdWidth,borderColor:n.imgPopupBdColor,display:"none"}),z.css({position:"relative",width:n.imgPopupWidth,height:n.imgPopupHeight,overflow:"hidden"}),P.css({position:"absolute",top:0,left:0,width:n.imgPopupWidth*n.imgMainWidth/n.magnifierWidth,height:n.imgPopupHeight*n.imgMainHeight/n.magnifierHeight});var M=g.find(i(".iq-magnifier-img-overlay"));for(M.css({position:"absolute"}),w=0;w<n.imgOverlaySrc.length;w++)g.find(i(".iq-magnifier-img-overlay")).eq(w).attr("src",n.imgOverlaySrc[w]),g.find(i(".iq-magnifier-img-overlay")).eq(w).css({top:n.imgOverlayOffsetY[w],left:n.imgOverlayOffsetX[w]});var y,C,H,O,b,X,Y,F,T=c.width(),x=c.height(),I=c.offset().top,A=c.offset().top+x,D=c.offset().left,j=c.offset().left+T,k=z.width(),E=z.height(),Q=(z.offset().top,z.offset().top+E,z.offset().left,z.offset().left+k,1/n.zoomMaximum);return c.on("mouseenter mouseleave",o).on("mousemove",t).on("mousewheel",m),this}}(jQuery);