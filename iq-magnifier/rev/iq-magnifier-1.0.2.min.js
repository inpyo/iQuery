!function(i){i.fn.iqMagnifier=function(e){function o(i){"mouseenter"==i.type?(W.css({width:n.magnifierWidth,height:r}),q.fadeIn(100),window.onwheel=function(){return!1}):(q.fadeOut(100),window.onwheel=function(){return!0})}function t(i){s(),T=i.pageX,x=i.pageY,k+.5*O>T?(W.css({left:-1*n.magnifierBdWidth}),v.css({left:0})):T>k+I-.5*O?(W.css({left:I-O-n.magnifierBdWidth}),v.css({left:-1*(I-O)})):(W.css({left:T-k-.5*O-n.magnifierBdWidth}),v.css({left:-1*(T-k-.5*O)})),D+.5*b>x?(W.css({top:-1*n.magnifierBdWidth}),v.css({top:0})):x>D+A-.5*b?(W.css({top:A-b-n.magnifierBdWidth}),v.css({top:-1*(A-b)})):(W.css({top:x-D-.5*b-n.magnifierBdWidth}),v.css({top:-1*(x-D-.5*b)})),s(),a()}function m(i){s(),i.originalEvent.wheelDelta<0?O+n.zoomScale<I?(T-.5*(O+n.zoomScale)<k?(W.css({left:-1*n.magnifierBdWidth,width:"+="+n.zoomScale}),v.css({left:0})):T+.5*(O+n.zoomScale)>E?(W.css({left:-1*n.magnifierBdWidth+I-O-n.zoomScale,width:"+="+n.zoomScale}),v.css({left:-1*(I-O-n.zoomScale)})):(W.css({left:-1*n.magnifierBdWidth+T-k-.5*(O+n.zoomScale),width:"+="+n.zoomScale}),v.css({left:-1*(T-k-.5*(O+n.zoomScale))})),x-.5*(b+n.zoomScale*d)<D?(W.css({top:-1*n.magnifierBdWidth,height:"+="+n.zoomScale*d}),v.css({top:0})):x+.5*(b+n.zoomScale*d)>j?(W.css({top:-1*n.magnifierBdWidth+A-b-n.zoomScale*d,height:"+="+n.zoomScale*d}),v.css({top:-1*(A-b-n.zoomScale*d)})):(W.css({top:-1*n.magnifierBdWidth+x-D-.5*(b+n.zoomScale*d),height:"+="+n.zoomScale*d}),v.css({top:-1*(x-D-.5*(b+n.zoomScale*d))}))):(W.css({top:-1*n.magnifierBdWidth,left:-1*n.magnifierBdWidth,width:I,height:A}),v.css({top:0,left:0})):O-n.zoomScale>I*Q?(T-.5*O+.5*n.zoomScale<k?(W.css({left:-1*n.magnifierBdWidth,width:"-="+n.zoomScale}),v.css({left:0})):T+.5*O-.5*n.zoomScale>E?(W.css({left:-1*n.magnifierBdWidth+I-O+n.zoomScale,width:"-="+n.zoomScale}),v.css({left:-1*(I-O+n.zoomScale)})):(W.css({left:-1*n.magnifierBdWidth+T-k-.5*(O-n.zoomScale),width:"-="+n.zoomScale}),v.css({left:-1*(T-k-.5*(O-n.zoomScale))})),x-.5*b+n.zoomScale*d*.5<D?(W.css({top:-1*n.magnifierBdWidth,height:"-="+n.zoomScale*d}),v.css({top:0})):x+.5*b-n.zoomScale*d*.5>j?(W.css({top:-1*n.magnifierBdWidth+A-b+n.zoomScale*d,height:"-="+n.zoomScale*d}),v.css({top:-1*(A-b+n.zoomScale*d)})):(W.css({top:-1*n.magnifierBdWidth+x-D-.5*(b-n.zoomScale*d),height:"-="+n.zoomScale*d}),v.css({top:-1*(x-D-.5*(b-n.zoomScale*d))}))):(k>T-I*Q*.5?(W.css({left:-1*n.magnifierBdWidth,width:I*Q}),v.css({left:0})):T+I*Q*.5>E?(W.css({left:-1*n.magnifierBdWidth+I-I*Q,width:I*Q}),v.css({left:-1*(I-I*Q)})):(W.css({left:-1*n.magnifierBdWidth+T-k-I*Q*.5,width:I*Q}),v.css({left:-1*(T-k-I*Q*.5)})),D>x-A*Q*.5?(W.css({top:-1*n.magnifierBdWidth,height:A*Q}),v.css({top:0})):x+A*Q*.5>j?(W.css({top:-1*n.magnifierBdWidth+A-A*Q,height:A*Q}),v.css({top:-1*(A-A*Q)})):(W.css({top:-1*n.magnifierBdWidth+x-D-A*Q*.5,height:A*Q}),v.css({top:-1*(x-D-A*Q*.5)}))),s(),a()}function s(){O=S.width(),b=S.height(),H=S.offset().top,X=S.offset().top+b,Y=S.offset().left,F=S.offset().left+O}function a(){var i=I/O;w.css({top:(H-D)*i*-1,left:(Y-k)*i*-1,width:I*i,height:A*i})}var g=i(this),n=i.extend({imgMainSrc:"",imgMainWidth:480,imgMainHeight:"",imgMainBdWidth:20,imgMainBdColor:"#CCCCCC",imgPopupSrc:"",imgPopupWidth:"",imgPopupHeight:"",imgPopupBdWidth:"",imgPopupBdColor:"",imgPopupPosition:"right",imgPopupOffsetX:50,imgPopupOffsetY:0,imgOverlaySrc:"",imgOverlayOffsetX:"",imgOverlayOffsetY:"",magnifierWidth:200,magnifierBdWidth:10,magnifierBdColor:"#AA0000",zoomScale:20,zoomMaximum:4,dimType:"colored",dimColor:"#2266AA",dimDepth:.4},e);n.imgMainHeight||(n.imgMainHeight=n.imgMainWidth),n.imgPopupSrc||(n.imgPopupSrc=n.imgMainSrc),n.imgPopupWidth||(n.imgPopupWidth=n.imgMainWidth),n.imgPopupHeight||(n.imgPopupHeight=n.imgMainHeight),n.imgPopupBdWidth||(n.imgPopupBdWidth=n.imgMainBdWidth),n.imgPopupBdColor||(n.imgPopupBdColor=n.imgMainBdColor);var d=n.imgMainHeight/n.imgMainWidth,r=n.magnifierWidth*d;if("tint"==n.dimType)n.dimColor="#FFFFFF";else if("shade"==n.dimType)n.dimColor="#000000";else if("none"==n.dimType)n.dimDepth=0;else if("colored"!=n.dimType)return alert("Invalid dimType"),!1;var f,h;if("right"==n.imgPopupPosition)f=n.imgMainWidth+n.imgMainBdWidth+n.imgPopupOffsetX,h=n.imgPopupOffsetY;else if("left"==n.imgPopupPosition)f=0-n.imgMainWidth-n.imgMainBdWidth-n.imgPopupOffsetX,h=n.imgPopupOffsetY;else if("top"==n.imgPopupPosition)f=n.imgPopupOffsetX,h=0-n.imgMainHeight-n.imgMainBdWidth-n.imgPopupOffsetY;else{if("bottom"!=n.imgPopupPosition)return alert("Invalid imgPopupPosition"),!1;f=n.imgPopupOffsetX,h=n.imgMainHeight+n.imgMainBdWidth+n.imgPopupOffsetY}var p='<div class="iq-magnifier-wrap"><div class="iq-magnifier-img-main-container-outside"><div class="iq-magnifier-img-main-container-inside"><div class="iq-magnifier-magnifier iq-magnifier-class-hover"><div class="iq-magnifier-img-magnifier-container iq-magnifier-class-hover"><img class="iq-magnifier-img-magnifier iq-magnifier-class-hover" src="'+n.imgMainSrc+'"></div></div><div class="iq-magnifier-dim iq-magnifier-class-hover"></div><img class="iq-magnifier-img-main" src="'+n.imgMainSrc+'"></div></div><div class="iq-magnifier-img-popup-container-outside iq-magnifier-class-hover"><div class="iq-magnifier-img-popup-container-inside iq-magnifier-class-hover"><img class="iq-magnifier-img-popup iq-magnifier-class-hover" src="'+n.imgPopupSrc+'"></div></div></div>';g.append(p);for(var l=g.find(i(".iq-magnifier-wrap")),c=g.find(i(".iq-magnifier-img-main-container-outside")),u=g.find(i(".iq-magnifier-img-main-container-inside")),W=g.find(i(".iq-magnifier-magnifier")),S=g.find(i(".iq-magnifier-img-magnifier-container")),v=g.find(i(".iq-magnifier-img-magnifier")),B=g.find(i(".iq-magnifier-dim")),P=g.find(i(".iq-magnifier-img-main")),z=g.find(i(".iq-magnifier-img-popup-container-outside")),M=g.find(i(".iq-magnifier-img-popup-container-inside")),w=g.find(i(".iq-magnifier-img-popup")),q=g.find(i(".iq-magnifier-class-hover")),y=0;y<n.imgOverlaySrc.length;y++)u.append('<img class="iq-magnifier-img-overlay">');l.css({position:"relative",margin:0,padding:0}),c.css({position:"absolute",top:0,left:0,width:n.imgMainWidth,height:n.imgMainHeight,borderStyle:"solid",borderWidth:n.imgMainBdWidth,borderColor:n.imgMainBdColor}),u.css({position:"relative",width:n.imgMainWidth,height:n.imgMainHeight,cursor:"crosshair"}),W.css({position:"absolute",top:0-n.magnifierBdWidth,left:0-n.magnifierBdWidth,width:n.magnifierWidth,height:r,borderStyle:"solid",borderWidth:n.magnifierBdWidth,borderColor:n.magnifierBdColor,zIndex:20,display:"none"}),S.css({position:"relative",width:"100%",height:"100%",overflow:"hidden"}),v.css({position:"absolute",width:n.imgMainWidth,height:n.imgMainHeight}),B.css({position:"absolute",top:0,left:0,width:n.imgMainWidth,height:n.imgMainHeight,backgroundColor:n.dimColor,opacity:n.dimDepth,zIndex:10,display:"none"}),P.css({position:"absolute",top:0,left:0,width:n.imgMainWidth,height:n.imgMainHeight}),z.css({position:"absolute",top:h,left:f,width:n.imgPopupWidth,height:n.imgPopupHeight,borderStyle:"solid",borderWidth:n.imgPopupBdWidth,borderColor:n.imgPopupBdColor,display:"none"}),M.css({position:"relative",width:n.imgPopupWidth,height:n.imgPopupHeight,overflow:"hidden"}),w.css({position:"absolute",top:0,left:0,width:n.imgPopupWidth*n.imgMainWidth/n.magnifierWidth,height:n.imgPopupHeight*n.imgMainHeight/r});var C=g.find(i(".iq-magnifier-img-overlay"));for(C.css({position:"absolute"}),y=0;y<n.imgOverlaySrc.length;y++)C.eq(y).attr("src",n.imgOverlaySrc[y]),C.eq(y).css({top:n.imgOverlayOffsetY[y],left:n.imgOverlayOffsetX[y]});var O,b,H,X,Y,F,T,x,I=u.width(),A=u.height(),D=u.offset().top,j=u.offset().top+A,k=u.offset().left,E=u.offset().left+I,Q=1/n.zoomMaximum;return u.on("mouseenter mouseleave",o).on("mousemove",t).on("mousewheel",m),this}}(jQuery);